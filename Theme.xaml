<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:sys="clr-namespace:System;assembly=mscorlib">
                

    <!-- Brushes you already update in code -->
    <SolidColorBrush x:Key="AppBackground" Color="Transparent"/>
    <SolidColorBrush x:Key="AppForeground" Color="Transparent"/>
    <SolidColorBrush x:Key="AppBorderBrush" Color="Transparent"/>

    <SolidColorBrush x:Key="BoxesBorderBrush" Color="Transparent"/>
    <SolidColorBrush x:Key="BoxesBackgroundBrush" Color="Transparent" Opacity="0.0"/>
    <Color x:Key="BoxesColor">#00000000</Color>

    <!-- Your slider writes to this Thickness -->
    <Thickness x:Key="AppBorderThickness">1</Thickness>
    <!-- Stroke for the visual overlay (use sys:Double, not x:Double) -->
    <sys:Double x:Key="AppBorderStrokeThickness">1</sys:Double>
    
        <!-- Global GroupBox: real border = 1 (stable), visual stroke overlays (no layout shift) -->
    <Style TargetType="GroupBox">
        <Setter Property="Foreground" Value="{DynamicResource AppForeground}"/>
        <Setter Property="Background" Value="{DynamicResource BoxesBackgroundBrush}"/>
        <Setter Property="BorderBrush" Value="{DynamicResource AppBorderBrush}"/>
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="GroupBox">
                    <Grid>
                        <!-- Stable inner -->
                        <Border CornerRadius="6"
                    BorderBrush="{TemplateBinding BorderBrush}"
                    BorderThickness="{TemplateBinding BorderThickness}"
                    Background="{TemplateBinding Background}"
                    Padding="12" Margin="0,10,0,0"/>

                        <!-- Header chip -->
                        <Border Background="{DynamicResource AppBackground}"
                    TextElement.Foreground="{DynamicResource AppForeground}"
                    Padding="4,0" HorizontalAlignment="Left" Margin="12,0,0,0">
                            <ContentPresenter ContentSource="Header" VerticalAlignment="Center"/>
                        </Border>

                        <!-- Content -->
                        <ContentPresenter Margin="12,18,12,12"/>

                        <!-- Visual stroke overlay (doesn't affect layout) -->
                        <Rectangle RadiusX="6" RadiusY="6"
                       IsHitTestVisible="False"
                       Stroke="{DynamicResource AppBorderBrush}"
                       StrokeThickness="{DynamicResource AppBorderStrokeThickness}"
                       Margin="0,10,0,0"/>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- Remove the old SectionBorder ControlTemplate. If you had one, delete it. -->
</ResourceDictionary>
